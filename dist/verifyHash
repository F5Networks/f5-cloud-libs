cli script /Common/verifyHash {
proc script::run {} {
        if {[catch {
            set hashes(f5-cloud-libs.tar.gz) 93313a28dcd0928fd00dba3cbf76a5a9f4c84fded004a7170766c8460768077ed62c11d60095eff0317d267c001e7ccc9ce4f6a02b278ccce0fb55bbdd9c19ba
            set hashes(f5-cloud-libs-aws.tar.gz) 4c00091adf268f591ee7970efb40c61d73b9646a036599061d504d2163f60f2f8453c78ee6d2ddf1419d23594663b033828d1a6944f5b3a4f362b749873128bf
            set hashes(f5-cloud-libs-azure.tar.gz) f8c2d93659beb796201ab27394888dde635845ee7bb466c01e2ba1dea880cf28fdf8b4c1845b47e389a3337a900d84ca576aef10cda8a99fd49c96c0a0b95d7b
            set hashes(f5-cloud-libs-gce.tar.gz) 7d5a44dbdac712e8e378c827f1dbabad40c2f9de38577881404c95cc5aaf64f3b22acaad41c8274d35fabf54321d66c20cbe95b35e1043e4a185a50f965daf09
            set hashes(f5-cloud-libs-openstack.tar.gz) db8eeccc429c91a53bb69c07be6a55a1b7a47d0a1548b19a32fe3fe948c18597363a9ae7a536548f72dd2a129a736cc4ac32bf324fdeb75390329dca122605f0
            set hashes(asm-policy-linux.tar.gz) 63b5c2a51ca09c43bd89af3773bbab87c71a6e7f6ad9410b229b4e0a1c483d46f1a9fff39d9944041b02ee9260724027414de592e99f4c2475415323e18a72e0
            set hashes(f5.http.v1.2.0rc4.tmpl) 47c19a83ebfc7bd1e9e9c35f3424945ef8694aa437eedd17b6a387788d4db1396fefe445199b497064d76967b0d50238154190ca0bd73941298fc257df4dc034
            set hashes(f5.http.v1.2.0rc6.tmpl) 811b14bffaab5ed0365f0106bb5ce5e4ec22385655ea3ac04de2a39bd9944f51e3714619dae7ca43662c956b5212228858f0592672a2579d4a87769186e2cbfe
            set hashes(f5.http.v1.2.0rc7.tmpl) 21f413342e9a7a281a0f0e1301e745aa86af21a697d2e6fdc21dd279734936631e92f34bf1c2d2504c201f56ccd75c5c13baa2fe7653213689ec3c9e27dff77d
            set hashes(f5.aws_advanced_ha.v1.3.0rc1.tmpl) 9e55149c010c1d395abdae3c3d2cb83ec13d31ed39424695e88680cf3ed5a013d626b326711d3d40ef2df46b72d414b4cb8e4f445ea0738dcbd25c4c843ac39d
            set hashes(f5.aws_advanced_ha.v1.4.0rc1.tmpl) de068455257412a949f1eadccaee8506347e04fd69bfb645001b76f200127668e4a06be2bbb94e10fefc215cfc3665b07945e6d733cbe1a4fa1b88e881590396
            set hashes(f5.aws_advanced_ha.v1.4.0rc2.tmpl) 6ab0bffc426df7d31913f9a474b1a07860435e366b07d77b32064acfb2952c1f207beaed77013a15e44d80d74f3253e7cf9fbbe12a90ec7128de6facd097d68f
            set hashes(asm-policy.tar.gz) 2d39ec60d006d05d8a1567a1d8aae722419e8b062ad77d6d9a31652971e5e67bc4043d81671ba2a8b12dd229ea46d205144f75374ed4cae58cefa8f9ab6533e6
            set hashes(deploy_waf.sh) 1a3a3c6274ab08a7dc2cb73aedc8d2b2a23cd9e0eb06a2e1534b3632f250f1d897056f219d5b35d3eed1207026e89989f754840fd92969c515ae4d829214fb74
            set hashes(f5.policy_creator.tmpl) 06539e08d115efafe55aa507ecb4e443e83bdb1f5825a9514954ef6ca56d240ed00c7b5d67bd8f67b815ee9dd46451984701d058c89dae2434c89715d375a620
            set hashes(f5.service_discovery.tmpl) 6e88b2c3a88d980cfcbb55f40a7cc362945b94eb8db7569c37217931414101c867dc3ed769b665fe27a7598a5e88fb1281bedc03f827e5a5c1ca49f58d0fa618
            set hashes(f5.cloud_logger.v1.0.0.tmpl) a26d5c470e70b821621476bcfd0579dbc0964f6a54158bc6314fa1e2f63b23bf3f3eb43ade5081131c24e08579db2e1e574beb3f8d9789d28acb4f312fad8c3e

            set file_path [lindex $tmsh::argv 1]
            set file_name [file tail $file_path]

            if {![info exists hashes($file_name)]} {
                tmsh::log err "No hash found for $file_name"
                exit 1
            }

            set expected_hash $hashes($file_name)
            set computed_hash [lindex [exec /usr/bin/openssl dgst -r -sha512 $file_path] 0]
            if { $expected_hash eq $computed_hash } {
                exit 0
            }
            tmsh::log err "Hash does not match for $file_path"
            exit 1
        }]} {
            tmsh::log err {Unexpected error in verifyHash}
            exit 1
        }
    }
    script-signature fnWGCy5sdY47sUVzBZoZM4fgkNv3r0X2J1ZOoUZa6X7VUMP4r4ndl7yJ5XDHf+AT55TZ9KAdiksPn+iXslpO/x+QTQU9wN3ol7P+x0CTaGBnvS7qnYyeyXYrQAjJPAGMS0/Rl90zudpU85t9Tko1pe/vxAS5eCEP/Pv4ROA35Rh1lhO8VdnWwjJ9PoOYJ2OcxE8smmuRVL3x8Yka//ZogHKbeQL6qGbMpXiaOgyrezCXtKOQEpFuJmCM+Ov4q8WQckBw+ktcOh4SZPMzGOp/9H3/laFP6UNZFOltdrsQfmCyRxfyEGOhF7vgLVWP3NIBOT24Ij/q3eMOo0f+IKJedA==
    signing-key /Common/f5-irule
}