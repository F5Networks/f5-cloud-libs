cli script /Common/verifyHash {
proc script::run {} {
        if {[catch {
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
            set hashes(f5-cloud-libs.tar.gz) ea27ea21fd82fb428e266060446ad41ad3a36edadd889569a5bdd1a29eae47cb8b720a58c508fe88eb888419eb2f9d5624145972b2cacda983c63dc24e62f9d2
=======
            set hashes(f5-cloud-libs.tar.gz) ea27ea21fd82fb428e266060446ad41ad3a36edadd889569a5bdd1a29eae47cb8b720a58c508fe88eb888419eb2f9d5624145972b2cacda983c63dc24e62f9d2
>>>>>>> clustertests
=======
            set hashes(f5-cloud-libs.tar.gz) ea27ea21fd82fb428e266060446ad41ad3a36edadd889569a5bdd1a29eae47cb8b720a58c508fe88eb888419eb2f9d5624145972b2cacda983c63dc24e62f9d2
>>>>>>> testcode
            set hashes(f5-cloud-libs-aws.tar.gz) 0b49d7b89a455d30eb9e8eadb126d1e60b8a7aad30f87ae691a21ad0d27087351e51e5e94236820b1d64aad1e6528c9bdf77c44a0c9cb058143edce59ba37d3b
=======
            set hashes(f5-cloud-libs.tar.gz) ea27ea21fd82fb428e266060446ad41ad3a36edadd889569a5bdd1a29eae47cb8b720a58c508fe88eb888419eb2f9d5624145972b2cacda983c63dc24e62f9d2
            set hashes(f5-cloud-libs-aws.tar.gz) 90058095cc536a057378a90ed19c3afe0cecd9034e1d1816745bd5ad837939623fad034ebd2ee9bdf594f33358b50c50f49a18c2ee7588ba89645142f2217330
>>>>>>> release-2.1.0
            set hashes(asm-policy-linux.tar.gz) 63b5c2a51ca09c43bd89af3773bbab87c71a6e7f6ad9410b229b4e0a1c483d46f1a9fff39d9944041b02ee9260724027414de592e99f4c2475415323e18a72e0
            set hashes(f5.http.v1.2.0rc4.tmpl) 47c19a83ebfc7bd1e9e9c35f3424945ef8694aa437eedd17b6a387788d4db1396fefe445199b497064d76967b0d50238154190ca0bd73941298fc257df4dc034
            set hashes(f5.http.v1.2.0rc6.tmpl) 811b14bffaab5ed0365f0106bb5ce5e4ec22385655ea3ac04de2a39bd9944f51e3714619dae7ca43662c956b5212228858f0592672a2579d4a87769186e2cbfe

            set file_path [lindex $tmsh::argv 1]
            set file_name [file tail $file_path]

            if {![info exists hashes($file_name)]} {
                tmsh::log err "No hash found for $file_name"
                exit 1
            }

            set expected_hash $hashes($file_name)
            set computed_hash [lindex [exec /usr/bin/openssl dgst -r -sha512 $file_path] 0]
            if { $expected_hash eq $computed_hash } {
                exit 0
            }
            tmsh::log err "Hash does not match for $file_path"
            exit 1
        }]} {
            tmsh::log err {Unexpected error in verifyHash}
            exit 1
        }
    }
}
